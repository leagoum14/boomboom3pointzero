<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Landing — XP Style</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Intro splash glitch -->
  <div class="intro" aria-hidden="true">
    <div class="glitch" style="--intro-img:url('assets/BOOMBOOM.png')"></div>
  </div>

  <div class="desktop" role="application" aria-label="Windows XP style desktop">
    <img class="wordart" src="assets/wordart.png" alt="12, 13, 14 décembre 2025" />
    <div class="desktop-icons" role="navigation" aria-label="Desktop shortcuts">
      <a class="icon img-icon" href="#infos" aria-label="Infos">
        <img src="assets/infos.png" alt="Infos" class="desk-img" />
        <span class="label">Infos</span>
      </a>
      <a class="icon img-icon" href="#skyblog" aria-label="Skyblog">
        <img src="assets/skyblog.png" alt="Skyblog" class="desk-img" />
        <span class="label">Skyblog</span>
      </a>
      <a class="icon img-icon" href="#msn" aria-label="MSN">
        <img src="assets/msn.png" alt="MSN" class="desk-img" />
        <span class="label">MSN</span>
      </a>
    </div>

    <!-- Taskbar -->
    <div class="taskbar" role="toolbar" aria-label="Barre des tâches">
      <button class="start-button" aria-label="Start">
        <img class="start-img" src="assets/Start Button.png" alt="Start" />
      </button>

      <div class="task-buttons">
        <button class="task active" aria-label="Projects">
          <img class="task-img" src="assets/Taskbar Button.png" alt="Projects" />
        </button>
      </div>

      <div class="tray" aria-label="System tray">
        <img class="tray-img" src="assets/Time + Language.png" alt="Language and clock" />
      </div>
    </div>
  </div>

  <script>
    /* ICON-SELECTION-LOGIC */
    (function(){
      const container = document.querySelector('.desktop-icons');
      if(!container) return;
      function clearSelection(){
        container.querySelectorAll('.icon.img-icon.selected').forEach(el => el.classList.remove('selected'));
      }
      document.addEventListener('click', function(e){
        const icon = e.target.closest && e.target.closest('.icon.img-icon');
        if(icon){
          const href = icon.getAttribute('href') || '';
          clearSelection();
          icon.classList.add('selected');
          if(href.startsWith('#')) e.preventDefault();
          return;
        }
        if(!e.target.closest('.taskbar') && !e.target.closest('.desktop-icons')){
          clearSelection();
        }
      });
    })();

    /* TASKBAR-AUTOHIDE */
    (function(){
      const bar = document.querySelector('.taskbar');
      if(!bar) return;
      let lastY = window.scrollY || 0, ticking=false;
      function update(){
        const mobile = window.matchMedia('(max-width: 640px)').matches;
        if(!mobile){ bar.classList.remove('hidden'); lastY = window.scrollY||0; return; }
        const y = window.scrollY||0; const down = y > lastY + 6; const up = y < lastY - 6;
        if(down && y > 12){ bar.classList.add('hidden'); } else if(up){ bar.classList.remove('hidden'); }
        lastY = y;
      }
      window.addEventListener('scroll', ()=>{
        if(!ticking){ requestAnimationFrame(()=>{ update(); ticking=false; }); ticking=true; }
      }, {passive:true});
      window.addEventListener('resize', update); update();
    })();

    /* INTRO-GLITCH-BOOT (v2: 2s static -> glitch -> flash -> reveal + sound) */
    (function(){
      const intro = document.querySelector('.intro');
      const glitchLayer = document.querySelector('.glitch');
      if(!intro || !glitchLayer) return;
      const flash = document.createElement('div'); flash.className = 'flash'; intro.appendChild(flash);
      const audio = new Audio('assets/glitch.wav'); audio.preload = 'auto'; audio.volume = 0.6;
      function tryPlay(){
        const p = audio.play();
        if(p && typeof p.then === 'function'){
          p.catch(()=>{ const once=()=>{ audio.play().catch(()=>{}); window.removeEventListener('pointerdown', once); };
                        window.addEventListener('pointerdown', once, {once:true}); });
        }
      }
      const t0 = 2000, glitchDur = 1200, flashDur = 120;
      setTimeout(()=>{
        intro.classList.add('glitching'); tryPlay();
        setTimeout(()=>{ flash.classList.add('show'); setTimeout(()=>{ intro.classList.add('hidden'); }, flashDur); }, glitchDur);
      }, t0);
    })();
  </script>
</body>
</html>
