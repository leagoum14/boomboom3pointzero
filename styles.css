:root{
  --bg-image: url('assets/bliss.jpg');
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,Segoe UI,Arial,sans-serif;color:#fff}

/* Desktop */
.desktop{
  position: relative;
  min-height:100dvh;
  display:flex; flex-direction:column;
  background-image: var(--bg-image);
  background-size: cover; background-position: center; background-repeat: no-repeat;
  padding-bottom: 60px; /* space for fixed taskbar */
}
@supports (padding-bottom: env(safe-area-inset-bottom)){
  .desktop{ padding-bottom: calc(60px + env(safe-area-inset-bottom)) }
}

/* Wordart overlay */
.wordart{
  position:absolute;
  top: clamp(12px, 6vh, 64px);
  right: clamp(8px, 4vw, 48px);
  width: min(36vw, 420px);
  max-width: 90vw;
  height:auto;
  z-index: 2;
  pointer-events: none;
  filter: drop-shadow(0 8px 24px rgba(0,0,0,.35));
}
@media (max-width: 900px){ .wordart{ width: min(48vw, 380px) } }
@media (max-width: 640px){
  .wordart{ width: min(70vw, 320px); top: 12px; right: 12px }
}

/* Desktop icons */
.desktop-icons{ display:grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
  gap: 16px 8px; padding: 16px }
.icon{ width:110px; text-decoration:none; display:flex; flex-direction:column; align-items:center;
  gap:8px; padding:6px 4px 10px; border-radius:10px; border:1px solid transparent; color:#e8f2ff }
.icon .label{ display:block; text-align:center; font-size:12px; text-shadow:0 2px 2px rgba(0,0,0,.55) }
.desk-img{ width:72px; height:auto; image-rendering: crisp-edges; display:block }
@media (max-width:640px){ .desk-img{ width:60px } }
.icon.img-icon:hover{
  background: rgba(52,116,229,.22);
  border-color: rgba(255,255,255,.4);
  box-shadow: 0 0 0 1px rgba(24,76,178,.65) inset, 0 1px 0 rgba(255,255,255,.35) inset;
}
.icon.img-icon.selected{
  background: linear-gradient(180deg, rgba(120,170,255,.9), rgba(60,120,235,.95) 60%, rgba(40,95,210,.95));
  border-color: #96c0ff;
  box-shadow: 0 0 0 1px rgba(18,72,180,.8) inset, 0 2px 0 rgba(255,255,255,.35) inset, 0 6px 12px rgba(0,0,0,.15);
}
.icon.img-icon.selected .label{ color:#fff; font-weight:700 }

/* Taskbar fixed bottom */
.taskbar{
  position:fixed; bottom:0; left:0; right:0;
  height:56px; background:#245edb; display:flex; align-items:center; gap:10px;
  padding:6px 8px; z-index:1000;
}
.start-button{ background:none; border:none; padding:0 }
.task{ background:none; border:none; padding:0 }
.start-img{ height:48px; display:block }
.task-img{ height:44px; display:block }
.tray{ margin-left:auto; display:flex; align-items:center; justify-content:flex-end; height:100% }
.tray-img{ height:48px; display:block }

/* Mobile compact bar + auto-hide */
@media (max-width: 640px){
  .taskbar{ height:64px; padding:6px 10px; will-change: transform; transform: translateY(0); transition: transform .25s ease }
  .taskbar.hidden{ transform: translateY(calc(100% + env(safe-area-inset-bottom))) }
  @supports (padding-bottom: env(safe-area-inset-bottom)){
    .taskbar{ padding-bottom: max(8px, env(safe-area-inset-bottom)) }
    .desktop{ padding-bottom: calc(64px + env(safe-area-inset-bottom)) }
  }
  .start-img{ height:40px }
  .task-img{ height:36px }
  .tray-img{ height:40px }
  .task-buttons{ overflow-x:auto; -webkit-overflow-scrolling: touch }
}

/* === Intro splash glitch === */
.intro{
  position: fixed; inset: 0; background: #000; z-index: 2000;
  opacity: 1; transition: opacity .45s ease, visibility 0s linear .5s; visibility: visible;
}
.intro.hidden{ opacity: 0; visibility: hidden }
.glitch{ position: absolute; inset: 0; background-image: var(--intro-img); background-size: cover; background-position: center }
.intro::after{ content:''; position:absolute; inset:0; pointer-events:none;
  background: repeating-linear-gradient(to bottom, rgba(0,0,0,.25) 0px, rgba(0,0,0,.25) 2px, rgba(0,0,0,0) 3px, rgba(0,0,0,0) 4px);
  mix-blend-mode: multiply; opacity:.35; animation: flicker .9s steps(2,end) 0s 2;
}
.glitch::before, .glitch::after{ content:''; position:absolute; inset:0; background-image: var(--intro-img);
  background-size: cover; background-position: center; mix-blend-mode: screen; opacity:.9; animation-play-state: paused;
}
.intro.glitching .glitch::before, .intro.glitching .glitch::after{ animation-play-state: running }
.glitch::before{
  filter: hue-rotate(25deg) saturate(1.3) contrast(1.1);
  animation: glitchTop 1.2s steps(1,end) both;
}
.glitch::after{
  filter: hue-rotate(-25deg) saturate(1.4) contrast(1.15);
  animation: glitchBot 1.2s steps(1,end) both;
}
@keyframes glitchTop{
  0%{ clip-path: inset(0 0 70% 0); transform: translateX(0) }
  6%{ clip-path: inset(0 0 72% 0); transform: translateX(-10px) }
  12%{ clip-path: inset(0 0 65% 0); transform: translateX(8px) }
  22%{ clip-path: inset(0 0 75% 0); transform: translateX(-16px) }
  32%{ clip-path: inset(0 0 60% 0); transform: translateX(6px) }
  46%{ clip-path: inset(0 0 70% 0); transform: translateX(-12px) }
  60%{ clip-path: inset(0 0 65% 0); transform: translateX(12px) }
  78%{ clip-path: inset(0 0 80% 0); transform: translateX(-18px) }
  92%{ clip-path: inset(0 0 68% 0); transform: translateX(10px) }
  100%{ clip-path: inset(0 0 100% 0); transform: translateX(0) }
}
@keyframes glitchBot{
  0%{ clip-path: inset(70% 0 0 0); transform: translateX(0) }
  6%{ clip-path: inset(72% 0 0 0); transform: translateX(12px) }
  12%{ clip-path: inset(65% 0 0 0); transform: translateX(-8px) }
  22%{ clip-path: inset(75% 0 0 0); transform: translateX(16px) }
  32%{ clip-path: inset(60% 0 0 0); transform: translateX(-6px) }
  46%{ clip-path: inset(70% 0 0 0); transform: translateX(14px) }
  60%{ clip-path: inset(65% 0 0 0); transform: translateX(-10px) }
  78%{ clip-path: inset(80% 0 0 0); transform: translateX(18px) }
  92%{ clip-path: inset(68% 0 0 0); transform: translateX(-10px) }
  100%{ clip-path: inset(100% 0 0 0); transform: translateX(0) }
}
@keyframes flicker{ 0%,100%{ opacity:.35 } 50%{ opacity:.2 } }

/* Flash cut */
.intro .flash{ position:absolute; inset:0; background:#fff; opacity:0; pointer-events:none }
.intro .flash.show{ animation: flashCut .12s ease both }
@keyframes flashCut{ 0%{opacity:0} 10%{opacity:1} 100%{opacity:0} }
